<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSG, Real, Benfica... Jusqu'à 100€ offerts sur la soirée avec Betclic ! ⚽️ (png)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div class="viewer-layout">
        <!-- Main Content -->
        <div class="viewer-main">
            <!-- Header -->
            <header class="viewer-header">
                <div style="display: flex; align-items: center; gap: 16px;">
                    <h1
                        style="font-family: var(--font-header); font-size: 1rem; font-weight: 600; margin: 0; max-width: 500px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--accent-blue);">
                        PSG, Real, Benfica... Jusqu'à 100€ offerts sur la soirée avec Betclic ! ⚽️ (png)
                    </h1>
                </div>

                <div style="display: flex; align-items: center; gap: 12px;">
                    <div class="viewer-toolbar">
                        <button class="btn btn-secondary" onclick="toggleHighlightLinks()"
                            title="Highlight all links (H)">
                            <span id="highlightBtnText">Show Links</span>
                        </button>
                        <button class="btn btn-secondary" onclick="downloadEmailZip()" title="Download Email (D)">
                            Download
                        </button>
                    </div>

                    <span class="crm-badge" data-crm="Unknown">Unknown</span>

                    <div class="device-toggle hide-mobile">
                        <button class="device-btn" onclick="setMode('mobile')" title="Mobile (1)">Mobile</button>
                        <button class="device-btn" onclick="setMode('tablet')" title="Tablet (2)">Tablet</button>
                        <button class="device-btn active" onclick="setMode('desktop')"
                            title="Desktop (3)">Desktop</button>
                    </div>

                    <button class="btn-icon" id="theme-toggle" onclick="toggleTheme()" title="Toggle Theme (T)">
                        <svg class="icon icon-moon" viewBox="0 0 24 24">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg class="icon icon-sun" style="display:none;" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Email Content -->
            <div class="viewer-content">
                <div id="deviceFrame" data-mode="desktop"
                    style="width: 100%; max-width: 800px; height: 100%; transition: max-width 0.3s ease;">
                    <iframe id="emailFrame" class="email-frame"></iframe>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <aside class="viewer-sidebar">
            <div class="sidebar-header">
                <span class="sidebar-title">Metadata</span>
            </div>

            <div class="sidebar-content">
                <!-- General Info -->
                <div class="meta-section">
                    <div class="meta-section-title">General</div>
                    <div class="meta-row">
                        <span class="meta-key">Sender</span>
                        <span class="meta-val">benoit@getinside.fr</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-key">Subject</span>
                        <span class="meta-val"
                            style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                            title="PSG, Real, Benfica... Jusqu'à 100€ offerts sur la soirée avec Betclic ! ⚽️ (png)">PSG, Real, Benfica... Jusqu'à 100€ offerts sur la soirée avec Betclic ! ⚽️ (png)</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-key">Preheader</span>
                        <span class="meta-val"
                            style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                            title="Parie sur la plus grande soirée de football européen avec Betclic. Jusqu’à 100€ reversés en Feebets* - Parie sur la plus grande soirée de football européen. UNE...">Parie sur la plus grande soirée de football européen avec Betclic. Jusqu’à 100€ reversés en Feebets* - Parie sur la plus grande soirée de football européen. UNE...</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-key">Received</span>
                        <span class="meta-val">08/01/2026 à 02:21</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-key">CRM</span>
                        <span class="meta-val text-cyan" style="font-weight: 700;">Unknown</span>
                    </div>
                </div>

                <!-- Technical -->
                <div class="meta-section">
                    <div class="meta-section-title">Technical</div>
                    <div class="meta-row">
                        <span class="meta-key">Size</span>
                        <span class="meta-val text-yellow">21.8 KB</span>
                    </div>
                    <div class="meta-row">
                        <span class="meta-key">Clipping Risk</span>
                        <span class="meta-val text-green"
                            style="font-weight: 700;">
                            Low
                        </span>
                    </div>
                </div>

                <!-- Tracking Pixels -->
                
                <div class="meta-section">
                    <div class="meta-section-title">Tracking Pixels (1)</div>
                    
                    <div class="link-card-v2" style="cursor: default; border-color: var(--accent-green); opacity: 0.9;">
                        <div class="card-v2-header" style="background: rgba(80, 250, 123, 0.05);">
                            <span class="card-v2-index" style="background: var(--accent-green);">P</span>
                            <span class="card-v2-domain">api.getinside.media</span>
                            <span class="card-v2-tag"
                                style="color: var(--accent-green); background: rgba(80, 250, 123, 0.1);">PIXEL</span>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text text-green">Integration: OK</div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://api.getinside.media/v1/emails/track/694a98b8910e8</code>
                                <button class="card-v2-copy-btn"
                                    onclick="event.stopPropagation(); copyLink(this, 'https://api.getinside.media/v1/emails/track/694a98b8910e8')">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                </div>
                

                <!-- All Links -->
                <div class="meta-section" style="flex: 1;">
                    <div class="meta-section-title">Links (7)</div>
                    
                    <div class="link-card-v2" onclick="highlightLink(1)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">1</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text"></div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/694a98b88f1c5</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/694a98b88f1c5', 1)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/694a98b88f1c5')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(2)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">2</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text"></div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/695eaf462d955</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/695eaf462d955', 2)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/695eaf462d955')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(3)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">3</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text">JE PARIE ></div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/695eaf462d955</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/695eaf462d955', 3)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/695eaf462d955')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(4)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">4</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text">JE PARIE ></div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/695eaf462d955</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/695eaf462d955', 4)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/695eaf462d955')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(5)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">5</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text">J'EN PROFITE</div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/695eaf462d955</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/695eaf462d955', 5)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/695eaf462d955')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(6)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">6</span>
                            <span class="card-v2-domain">External Link</span>
                            <div style="display: flex; gap: 4px;">
                                
                                <span class="card-v2-tag tag-unsecure"><svg width="8"
                                        height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="3">
                                        <path
                                            d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                                        <line x1="12" y1="9" x2="12" y2="13" />
                                        <line x1="12" y1="17" x2="12.01" y2="17" />
                                    </svg> HTTP</span>
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text">désinscrire ici</div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">#</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, '#', 6)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, '#')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="link-card-v2" onclick="highlightLink(7)">
                        <div class="card-v2-header">
                            <span class="card-v2-index">7</span>
                            <span class="card-v2-domain">gtinsi.de</span>
                            <div style="display: flex; gap: 4px;">
                                
                                
                                
                            </div>
                        </div>
                        <div class="card-v2-body">
                            <div class="card-v2-text"></div>
                            <div class="card-v2-url-zone">
                                <code class="card-v2-url">https://gtinsi.de/695eaf462ebf4</code>

                                <div
                                    style="display: flex; gap: 8px; margin-top: 8px; padding-top: 8px; justify-content: flex-end;">
                                    <button class="btn-card" title="Verify Link"
                                        onclick="event.stopPropagation(); runAudit(this, 'https://gtinsi.de/695eaf462ebf4', 7)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                    </button>
                                    <button class="btn-card" title="Copy URL"
                                        onclick="event.stopPropagation(); copyLink(this, 'https://gtinsi.de/695eaf462ebf4')">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Audit Log Container -->
                            <div class="audit-log-container">
                                <div class="audit-status-bar">
                                    <span class="audit-status-text">Scanning...</span>
                                </div>
                                <div class="audit-timeline">
                                    <!-- Log items will be injected here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- Sticky Footer in Sidebar -->
            <div class="sidebar-footer">
                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin: 0;">
                    © 2025 <a href="https://github.com/benoit-prentout" target="_blank"
                        style="color: var(--accent-cyan); text-decoration: underline dotted; font-weight: 600;">Benoît
                        Prentout</a>.
                    All rights reserved.
                </p>
            </div>
        </aside>
    </div>



    <!-- Link overlays container -->
    <div id="linkOverlays" style="position: fixed; top: 0; left: 0; pointer-events: none; z-index: 100;"></div>

    <script src="../assets/js/main.js"></script>
    <script>
        const content = "<!DOCTYPE html>\n\n<html dir=\"auto\" lang=\"und\" xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:v=\"urn:schemas-microsoft-com:vml\">\n<head>\n<title>Parie sur la plus grande soir\u00e9e de football europ\u00e9en avec Betclic.</title>\n<!--[if !mso]><!-->\n<meta content=\"IE=edge\" http-equiv=\"X-UA-Compatible\"/>\n<!--<![endif]-->\n<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\"/>\n<style type=\"text/css\">\n    #outlook a {\n      padding: 0;\n    }\n\n    body {\n      margin: 0;\n      padding: 0;\n      -webkit-text-size-adjust: 100%;\n      -ms-text-size-adjust: 100%;\n    }\n\n    table,\n    td {\n      border-collapse: collapse;\n      mso-table-lspace: 0pt;\n      mso-table-rspace: 0pt;\n    }\n\n    img {\n      border: 0;\n      height: auto;\n      line-height: 100%;\n      outline: none;\n      text-decoration: none;\n      -ms-interpolation-mode: bicubic;\n    }\n\n    p {\n      display: block;\n      margin: 13px 0;\n    }\n  </style>\n<!--[if mso]>\n    <noscript>\n    <xml>\n    <o:OfficeDocumentSettings>\n      <o:AllowPNG/>\n      <o:PixelsPerInch>96</o:PixelsPerInch>\n    </o:OfficeDocumentSettings>\n    </xml>\n    </noscript>\n    <![endif]-->\n<!--[if lte mso 11]>\n    <style type=\"text/css\">\n      .mj-outlook-group-fix { width:100% !important; }\n    </style>\n    <![endif]-->\n<!--[if !mso]><!-->\n<link href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&amp;display=swap\" rel=\"stylesheet\" type=\"text/css\"/>\n<link href=\"https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&amp;display=swap\" rel=\"stylesheet\" type=\"text/css\"/>\n<style type=\"text/css\">\n    @import url(https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap);\n    @import url(https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&display=swap);\n  </style>\n<!--<![endif]-->\n<style type=\"text/css\">\n    @media only screen and (min-width:480px) {\n      .mj-column-per-100 {\n        width: 100% !important;\n        max-width: 100%;\n      }\n\n      .mj-column-per-90 {\n        width: 90% !important;\n        max-width: 90%;\n      }\n\n      .mj-column-per-48 {\n        width: 48% !important;\n        max-width: 48%;\n      }\n\n      .mj-column-per-4 {\n        width: 4% !important;\n        max-width: 4%;\n      }\n    }\n  </style>\n<style media=\"screen and (min-width:480px)\">\n    .moz-text-html .mj-column-per-100 {\n      width: 100% !important;\n      max-width: 100%;\n    }\n\n    .moz-text-html .mj-column-per-90 {\n      width: 90% !important;\n      max-width: 90%;\n    }\n\n    .moz-text-html .mj-column-per-48 {\n      width: 48% !important;\n      max-width: 48%;\n    }\n\n    .moz-text-html .mj-column-per-4 {\n      width: 4% !important;\n      max-width: 4%;\n    }\n  </style>\n<style type=\"text/css\">\n    @media only screen and (max-width:479px) {\n      table.mj-full-width-mobile {\n        width: 100% !important;\n      }\n\n      td.mj-full-width-mobile {\n        width: auto !important;\n      }\n    }\n  </style>\n<style type=\"text/css\">\n    .cta-btn:hover a {\n      background-color: #b00029 !important;\n    }\n\n    .match-btn:hover a {\n      background-color: #e6bd00 !important;\n    }\n\n    @media (max-width:480px) {\n      .mobile-title div {\n        font-size: 34px !important;\n        line-height: 38px !important;\n      }\n    }\n  </style>\n</head>\n<body style=\"word-spacing:normal;background-color:#f5f5f5;\">\n<div style=\"display:none;font-size:1px;color:#ffffff;line-height:1px;max-height:0px;max-width:0px;opacity:0;overflow:hidden;\">Jusqu\u2019\u00e0 100\u20ac revers\u00e9s en Feebets* - Parie sur la plus grande soir\u00e9e de football europ\u00e9en.</div>\n<div aria-label=\"Parie sur la plus grande soir\u00e9e de football europ\u00e9en avec Betclic.\" aria-roledescription=\"email\" dir=\"auto\" lang=\"und\" role=\"article\" style=\"background-color:#f5f5f5;\">\n<!-- HEADER -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#E10014\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#E10014;background-color:#E10014;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#E10014;background-color:#E10014;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:20px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:560px;\" ><![endif]-->\n<div class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\">\n<tbody>\n<tr>\n<td style=\"width:140px;\">\n<a data-index=\"1\" href=\"https://gtinsi.de/694a98b88f1c5\" target=\"_blank\">\n<img alt=\"Betclic\" height=\"auto\" src=\"img_0.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"140\"/>\n</a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- HERO IMAGE (NOUVEAU GIF) + BANDEAU LEGAL -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#111111\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#111111;background-color:#111111;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#111111;background-color:#111111;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:0;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n<div class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<!-- Le GIF Hero -->\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:0;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\">\n<tbody>\n<tr>\n<td style=\"width:600px;\">\n<a data-index=\"2\" href=\"https://gtinsi.de/695eaf462d955\" target=\"_blank\">\n<img alt=\"Parie sur l'Europe - Jusqu'\u00e0 100\u20ac de Feebets rembours\u00e9s\" height=\"auto\" src=\"img_1.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"600\"/>\n</a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- TITRE -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:0px;padding-bottom:25px;padding-left:20px;padding-right:20px;padding-top:35px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:560px;\" ><![endif]-->\n<div class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" class=\"mobile-title\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\">\n<div style=\"font-family:Teko, sans-serif;font-size:44px;font-weight:700;line-height:44px;text-align:center;text-transform:uppercase;color:#111111;\">UNE GRANDE SOIR\u00c9E EUROP\u00c9ENNE, PARIE SUR LA DERNI\u00c8RE JOURN\u00c9E !</div>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- BULLET POINTS (Emojis \u00c9clairs) -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:0px;padding-bottom:30px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:540px;\" ><![endif]-->\n<div class=\"mj-column-per-90 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"left\" style=\"font-size:0px;padding:0;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"color:#000000;font-family:Roboto, Arial, sans-serif;font-size:13px;line-height:22px;table-layout:auto;width:100%;border:none;\" width=\"100%\">\n<!-- Item 1 -->\n<tr>\n<td style=\"width: 35px; vertical-align: top; padding-bottom: 15px; padding-top:2px;\">\n<span style=\"color: #E10014; font-size: 24px; line-height: 24px;\">\u26a1</span>\n</td>\n<td style=\"vertical-align: top; padding-bottom: 15px;\">\n<span style=\"font-family:Roboto, sans-serif; font-size:18px; line-height:24px; color:#111111;\">\n<strong style=\"font-weight:700;\">18 matchs</strong> en simultan\u00e9 </span>\n</td>\n</tr>\n<!-- Item 2 -->\n<tr>\n<td style=\"width: 35px; vertical-align: top; padding-bottom: 15px; padding-top:2px;\">\n<span style=\"color: #E10014; font-size: 24px; line-height: 24px;\">\u26a1</span>\n</td>\n<td style=\"vertical-align: top; padding-bottom: 15px;\">\n<span style=\"font-family:Roboto, sans-serif; font-size:18px; line-height:24px; color:#111111;\">\n<strong style=\"font-weight:700;\">7 clubs</strong> fran\u00e7ais </span>\n</td>\n</tr>\n<!-- Item 3 -->\n<tr>\n<td style=\"width: 35px; vertical-align: top; padding-bottom: 15px; padding-top:2px;\">\n<span style=\"color: #E10014; font-size: 24px; line-height: 24px;\">\u26a1</span>\n</td>\n<td style=\"vertical-align: top; padding-bottom: 15px;\">\n<span style=\"font-family:Roboto, sans-serif; font-size:18px; line-height:24px; color:#111111;\">\n<strong style=\"font-weight:700;\">Des stars</strong> au rendez-vous </span>\n</td>\n</tr>\n<!-- Item 4 -->\n<tr>\n<td style=\"width: 35px; vertical-align: top; padding-bottom: 15px; padding-top:2px;\">\n<span style=\"color: #E10014; font-size: 24px; line-height: 24px;\">\u26a1</span>\n</td>\n<td style=\"vertical-align: top; padding-bottom: 15px;\">\n<span style=\"font-family:Roboto, sans-serif; font-size:18px; line-height:24px; color:#111111;\">\n<strong style=\"font-weight:700;\">Goals \u00e0 gogo</strong> : parie et enjaille-toi sur la derni\u00e8re journ\u00e9e europ\u00e9enne ! </span>\n</td>\n</tr>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- BLOC MATCHS -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:0px;padding-bottom:30px;padding-left:15px;padding-right:15px;padding-top:10px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><![endif]-->\n<!-- Match 1 : Paris vs Newcastle -->\n<!--[if mso | IE]><td class=\"\" style=\"vertical-align:top;width:273.6px;\" ><![endif]-->\n<div class=\"mj-column-per-48 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:separate;\" width=\"100%\">\n<tbody>\n<tr>\n<td style=\"background-color:#fafafa;border:1px solid #e5e5e5;border-radius:8px;vertical-align:top;border-collapse:separate;padding:15px;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;padding-bottom:5px;word-break:break-word;\">\n<div style=\"font-family:Teko, sans-serif;font-size:22px;font-weight:600;line-height:22px;text-align:center;text-transform:uppercase;color:#111111;\">PARIS SG <span style=\"color:#999999;\">vs</span> NEWCASTLE</div>\n</td>\n</tr>\n<tr>\n<td align=\"center\" class=\"match-btn\" style=\"font-size:0px;padding:10px 25px;padding-top:5px;padding-bottom:0;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:separate;width:100%;line-height:100%;\">\n<tbody>\n<tr>\n<td align=\"center\" bgcolor=\"#FFD200\" role=\"presentation\" style=\"border:none;border-radius:4px;cursor:auto;height:35px;mso-padding-alt:0;background:#FFD200;\" valign=\"middle\">\n<a data-index=\"3\" href=\"https://gtinsi.de/695eaf462d955\" style=\"display:inline-block;background:#FFD200;color:#111111;font-family:Roboto, sans-serif;font-size:16px;font-weight:900;line-height:120%;margin:0;text-decoration:none;text-transform:uppercase;padding:0;mso-padding-alt:0px;border-radius:4px;\" target=\"_blank\"> JE PARIE &gt; </a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td><![endif]-->\n<!-- Espaceur -->\n<!--[if mso | IE]><td class=\"\" style=\"vertical-align:top;width:22.8px;\" ><![endif]-->\n<div class=\"mj-column-per-4 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td style=\"font-size:0px;word-break:break-word;\">\n<div style=\"height:15px;line-height:15px;\">\u200a</div>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td><![endif]-->\n<!-- Match 2 : Benfica vs Real Madrid -->\n<!--[if mso | IE]><td class=\"\" style=\"vertical-align:top;width:273.6px;\" ><![endif]-->\n<div class=\"mj-column-per-48 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:separate;\" width=\"100%\">\n<tbody>\n<tr>\n<td style=\"background-color:#fafafa;border:1px solid #e5e5e5;border-radius:8px;vertical-align:top;border-collapse:separate;padding:15px;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;padding-bottom:5px;word-break:break-word;\">\n<div style=\"font-family:Teko, sans-serif;font-size:22px;font-weight:600;line-height:22px;text-align:center;text-transform:uppercase;color:#111111;\">BENFICA <span style=\"color:#999999;\">vs</span> R. MADRID</div>\n</td>\n</tr>\n<tr>\n<td align=\"center\" class=\"match-btn\" style=\"font-size:0px;padding:10px 25px;padding-top:5px;padding-bottom:0;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:separate;width:100%;line-height:100%;\">\n<tbody>\n<tr>\n<td align=\"center\" bgcolor=\"#FFD200\" role=\"presentation\" style=\"border:none;border-radius:4px;cursor:auto;height:35px;mso-padding-alt:0;background:#FFD200;\" valign=\"middle\">\n<a data-index=\"4\" href=\"https://gtinsi.de/695eaf462d955\" style=\"display:inline-block;background:#FFD200;color:#111111;font-family:Roboto, sans-serif;font-size:16px;font-weight:900;line-height:120%;margin:0;text-decoration:none;text-transform:uppercase;padding:0;mso-padding-alt:0px;border-radius:4px;\" target=\"_blank\"> JE PARIE &gt; </a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- CTA & MENTIONS -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#ffffff\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#ffffff;background-color:#ffffff;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#ffffff;background-color:#ffffff;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:0px;padding-bottom:45px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:600px;\" ><![endif]-->\n<div class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" class=\"cta-btn\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:separate;width:90%;line-height:100%;\">\n<tbody>\n<tr>\n<td align=\"center\" bgcolor=\"#E10014\" role=\"presentation\" style=\"border:none;border-radius:4px;cursor:auto;mso-padding-alt:15px 25px;background:#E10014;\" valign=\"middle\">\n<a data-index=\"5\" href=\"https://gtinsi.de/695eaf462d955\" style=\"display:inline-block;background:#E10014;color:#ffffff;font-family:Teko, sans-serif;font-size:30px;font-weight:700;line-height:120%;margin:0;text-decoration:none;text-transform:uppercase;padding:15px 25px;mso-padding-alt:0px;border-radius:4px;\" target=\"_blank\"> J'EN PROFITE </a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;padding-top:15px;word-break:break-word;\">\n<div style=\"font-family:Roboto, Arial, sans-serif;font-size:12px;font-style:italic;line-height:24px;text-align:center;color:#666666;\">*Montant de ton 1er pari revers\u00e9 en cr\u00e9dits de jeu non retirables s'il est perdant.</div>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n<!-- FOOTER -->\n<!--[if mso | IE]><table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"\" role=\"presentation\" style=\"width:600px;\" width=\"600\" bgcolor=\"#111111\" ><tr><td style=\"line-height:0px;font-size:0px;mso-line-height-rule:exactly;\"><![endif]-->\n<div style=\"background:#111111;background-color:#111111;margin:0px auto;max-width:600px;\">\n<table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"background:#111111;background-color:#111111;width:100%;\">\n<tbody>\n<tr>\n<td style=\"direction:ltr;font-size:0px;padding:20px;text-align:center;\">\n<!--[if mso | IE]><table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td class=\"\" style=\"vertical-align:top;width:560px;\" ><![endif]-->\n<div class=\"mj-column-per-100 mj-outlook-group-fix\" style=\"font-size:0px;text-align:left;direction:ltr;display:inline-block;vertical-align:top;width:100%;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"vertical-align:top;\" width=\"100%\">\n<tbody>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;word-break:break-word;\">\n<div style=\"font-family:Roboto, Arial, sans-serif;font-size:10px;line-height:14px;text-align:center;color:#999999;\">Cet email vous est envoy\u00e9 par Spacefoot.com.<br/> Si vous ne souhaitez plus recevoir nos offres exclusives, vous pouvez vous <a data-index=\"6\" href=\"#\" style=\"color: #cccccc; text-decoration: underline;\">d\u00e9sinscrire ici</a>.<br/> \u00a9 2026 Betclic est une marque d\u00e9pos\u00e9e. Tous droits r\u00e9serv\u00e9s.</div>\n</td>\n</tr>\n<tr>\n<td align=\"center\" style=\"font-size:0px;padding:10px 25px;padding-top:20px;word-break:break-word;\">\n<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\" style=\"border-collapse:collapse;border-spacing:0px;\">\n<tbody>\n<tr>\n<td style=\"width:80px;\">\n<a data-index=\"7\" href=\"https://gtinsi.de/695eaf462ebf4\" target=\"_blank\">\n<img alt=\"Getinside\" height=\"auto\" src=\"img_2.png\" style=\"border:0;display:block;outline:none;text-decoration:none;height:auto;width:100%;font-size:13px;\" width=\"80\"/>\n</a>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n<!-- Tracking Pixel --><img alt=\"\" height=\"1\" src=\"\" style=\"display:none !important;\" width=\"1\"/>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<!--[if mso | IE]></td></tr></table><![endif]-->\n</div>\n</body>\n</html>";
        const emailLinks = [{"index": 1, "txt": "", "original_url": "https://gtinsi.de/694a98b88f1c5", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/694a98b88f1c5"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 2, "txt": "", "original_url": "https://gtinsi.de/695eaf462d955", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/695eaf462d955"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 3, "txt": "JE PARIE >", "original_url": "https://gtinsi.de/695eaf462d955", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/695eaf462d955"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 4, "txt": "JE PARIE >", "original_url": "https://gtinsi.de/695eaf462d955", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/695eaf462d955"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 5, "txt": "J'EN PROFITE", "original_url": "https://gtinsi.de/695eaf462d955", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/695eaf462d955"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 6, "txt": "d\u00e9sinscrire ici", "original_url": "#", "final_url": "#", "domain": "", "is_tracking": false, "is_secure": false, "is_dev": false, "redirect_chain": [{"status": "Error", "url": "#"}], "audit_date": "2026-02-10 15:38:25"}, {"index": 7, "txt": "", "original_url": "https://gtinsi.de/695eaf462ebf4", "final_url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1", "domain": "gtinsi.de", "is_tracking": false, "is_secure": true, "is_dev": false, "redirect_chain": [{"status": 302, "url": "https://gtinsi.de/695eaf462ebf4"}, {"status": 301, "url": "https://betclic.onelink.me/2887093520/e278g8xh"}, {"status": 403, "url": "https://www.betclic.fr/inscription?id=GIS&zone=EMAIL_1&source_caller=ui&shortlink=e278g8xh&af_sub1=GIS&c=BCFR_GIS_EXP_ALL_EMAIL_1&pid=GetInside&af_xp=custom&af_adset=Campagne test&af_sub2=EMAIL_1"}], "audit_date": "2026-02-10 15:38:25"}];
        const frame = document.getElementById('emailFrame');
        let linksHighlighted = false;
        let overlayElements = [];
        let lastHighlightedIdx = null;
        let spotlightTimeout = null;

        function init() {
            const doc = frame.contentDocument;
            doc.open();
            doc.write(content);
            doc.close();

            const style = doc.createElement('style');
            style.innerHTML = `
                :root {
                    --spotlight-dim: rgba(0, 0, 0, 0.6);
                    --spotlight-glow: #50FA7B;
                }
                [data-theme="dark"] {
                    /* In Dark Mode (Inverted), we want the dimming to be light so it inverts to dark */
                    --spotlight-dim: rgba(255, 255, 255, 0.7);
                    /* And we use the complement of green so it inverts back to green */
                    --spotlight-glow: #AF0584; 
                }
                body { margin: 0; font-family: sans-serif; background: #fff; position: relative; }
                .link-outline { 
                    outline: 2px solid #8BE9FD !important; /* Cyan */
                    outline-offset: 1px !important;
                    transition: outline 0.2s ease;
                }
                .link-highlight-pulse {
                    animation: link-pulse 2s infinite;
                }
                @keyframes link-pulse {
                    0% { outline-color: #8BE9FD; outline-width: 2px; }
                    50% { outline-color: #BD93F9; outline-width: 4px; outline-offset: 3px; }
                    100% { outline-color: #8BE9FD; outline-width: 2px; }
                }
                .link-flash-spotlight {
                    position: relative !important;
                    z-index: 2147483647 !important;
                    outline: 8px solid var(--spotlight-glow) !important;
                    outline-offset: 4px !important;
                    box-shadow: 0 0 0 10000px var(--spotlight-dim), 0 0 40px var(--spotlight-glow) !important;
                    background-color: rgba(255, 255, 255, 1) !important;
                    color: #282a36 !important;
                }
            `;
            doc.head.appendChild(style);

            const theme = localStorage.getItem('theme') || 'light';
            if (theme === 'dark') applyTheme('dark');
        }

        function setMode(mode) {
            const frameEl = document.getElementById('deviceFrame');
            const iframeEl = document.getElementById('emailFrame');

            document.querySelectorAll('.device-btn').forEach(b => b.classList.remove('active'));
            const btn = document.querySelector(`.device-btn[onclick*="${mode}"]`);
            if (btn) btn.classList.add('active');

            // Remove/add scrollbar class
            if (mode === 'mobile') {
                frameEl.style.maxWidth = '375px';
                iframeEl.classList.add('no-scrollbar');
            } else if (mode === 'tablet') {
                frameEl.style.maxWidth = '600px';
                iframeEl.classList.add('no-scrollbar');
            } else {
                frameEl.style.maxWidth = '800px';
                iframeEl.classList.remove('no-scrollbar');
            }

            // Update overlays if visible
            if (linksHighlighted) {
                setTimeout(updateOverlays, 150);
            }
        }

        function highlightLink(idx) {
            const doc = frame.contentDocument;
            const link = doc.querySelector(`[data-index="${idx}"]`);
            if (link) {
                // Toggle Logic: If clicking the same link again, remove highlight
                if (lastHighlightedIdx === idx) {
                    doc.querySelectorAll('.link-flash-spotlight').forEach(el => el.classList.remove('link-flash-spotlight'));
                    if (!linksHighlighted) {
                        link.classList.remove('link-outline');
                    }
                    lastHighlightedIdx = null;
                    if (spotlightTimeout) clearTimeout(spotlightTimeout);
                    return;
                }

                lastHighlightedIdx = idx;

                // Ensure it's scrolled into view
                link.scrollIntoView({ behavior: 'smooth', block: 'center' });

                // Remove existing flash/spotlight from others
                doc.querySelectorAll('.link-flash-spotlight').forEach(el => el.classList.remove('link-flash-spotlight'));

                // Add spotlight class (this dims the rest of the iframe via large box-shadow)
                link.classList.add('link-flash-spotlight');

                // If Show Links is off, temporarily show this one's overlay/outline
                const wasHighlighted = linksHighlighted;
                if (!wasHighlighted) {
                    link.classList.add('link-outline');
                }

                if (spotlightTimeout) clearTimeout(spotlightTimeout);
                spotlightTimeout = setTimeout(() => {
                    link.classList.remove('link-flash-spotlight');
                    if (!wasHighlighted) {
                        link.classList.remove('link-outline');
                    }
                    if (lastHighlightedIdx === idx) lastHighlightedIdx = null;
                }, 4000); // 4 seconds spotlight
            }
        }

        function toggleHighlightLinks() {
            linksHighlighted = !linksHighlighted;
            const btn = document.getElementById('highlightBtnText');
            btn.textContent = linksHighlighted ? 'Hide Links' : 'Show Links';

            if (linksHighlighted) {
                createOverlays();
            } else {
                removeOverlays();
            }
        }

        function createOverlays() {
            removeOverlays();
            const doc = frame.contentDocument;
            const links = doc.querySelectorAll('[data-index]');
            const container = document.getElementById('linkOverlays');
            const frameRect = frame.getBoundingClientRect();

            links.forEach(link => {
                const idx = link.getAttribute('data-index');
                let rect = link.getBoundingClientRect();

                // Advanced Dimension Check: If element is "empty" or "inline-collapsed", check children or use parent
                if (rect.width <= 2 || rect.height <= 2) {
                    const children = link.querySelectorAll('img, table, div, span, p');
                    let found = false;
                    for (let child of children) {
                        const childRect = child.getBoundingClientRect();
                        if (childRect.width > 2 && childRect.height > 2) {
                            rect = childRect;
                            found = true;
                            break;
                        }
                    }
                    // If still no size, it might be a text-only link that is display: inline
                    // Try to get a range client rect if possible
                    if (!found) {
                        try {
                            const range = doc.createRange();
                            range.selectNodeContents(link);
                            const rangeRect = range.getBoundingClientRect();
                            if (rangeRect.width > 0) {
                                rect = rangeRect;
                            }
                        } catch (e) {
                            console.warn("Could not calculate range rect for link", idx);
                        }
                    }
                }

                // Final safety skip
                if (rect.width === 0 || rect.height === 0) return;

                // Clipping Logic: Only show badge if link is at least partially visible in iframe viewport
                // rect is relative to iframe viewport
                const iframeHeight = frame.clientHeight;
                const iframeWidth = frame.clientWidth;

                // If the link is fully out of view, skip it
                if (rect.bottom < 0 || rect.top > iframeHeight || rect.right < 0 || rect.left > iframeWidth) {
                    return;
                }

                // Create overlay badge
                const badge = document.createElement('div');
                badge.className = 'link-overlay-badge';
                badge.textContent = idx;

                // Position badge: top-right calculation relative to main window
                let badgeX, badgeY;
                if (rect.width < 15) {
                    badgeX = frameRect.left + rect.left + (rect.width / 2) - 10;
                    badgeY = frameRect.top + rect.top - 20;
                } else {
                    badgeX = frameRect.left + rect.left + rect.width - 6;
                    badgeY = frameRect.top + rect.top - 12;
                }

                // Ensure the badge itself is clipped by the frame boundaries
                // (e.g. don't let it overlap the header if the link is at the very top edge)
                if (badgeY < frameRect.top) {
                    // If the link is partially visible at top but badge would be outside,
                    // we can either hide it or stick it to the edge. Let's hide for clean look.
                    return;
                }
                if (badgeY > frameRect.bottom - 20) {
                    return;
                }

                badge.style.cssText = `
                    position: fixed;
                    left: ${badgeX}px;
                    top: ${badgeY}px;
                    background: #BD93F9; /* Purple for badges */
                    color: #fff;
                    font-size: 11px;
                    font-weight: 800;
                    padding: 0px 6px;
                    min-width: 20px;
                    height: 20px;
                    line-height: 20px;
                    border-radius: 10px;
                    font-family: 'Inter', sans-serif;
                    z-index: 1000;
                    box-shadow: 0 3px 6px rgba(0,0,0,0.5), 0 0 0 2px rgba(255,255,255,0.8);
                    text-align: center;
                    border: none;
                    pointer-events: none;
                    opacity: 1;
                    transition: transform 0.2s ease;
                `;
                container.appendChild(badge);
                overlayElements.push(badge);

                // Add highlight to link in iframe
                link.classList.add('link-outline');
                link.classList.add('link-highlight-pulse');
            });
        }

        function removeOverlays() {
            const container = document.getElementById('linkOverlays');
            container.innerHTML = '';
            overlayElements = [];

            // Remove outlines from iframe links
            const doc = frame.contentDocument;
            if (doc) {
                const links = doc.querySelectorAll('[data-index]');
                links.forEach(link => {
                    link.classList.remove('link-outline');
                    link.classList.remove('link-highlight-pulse');
                    link.classList.remove('link-flash-spotlight');
                });
            }
        }

        function updateOverlays() {
            if (linksHighlighted) {
                createOverlays();
            }
        }

        // Update overlays logic
        frame.addEventListener('load', () => {
            frame.contentWindow.addEventListener('scroll', () => {
                if (linksHighlighted) updateOverlays();
            });
            frame.contentWindow.addEventListener('resize', () => {
                if (linksHighlighted) updateOverlays();
            });
        });



        function copyLink(btn, url) {
            navigator.clipboard.writeText(url).then(() => {
                const originalHtml = btn.innerHTML;
                // Temporarily show checkmark
                btn.innerHTML = '<span style="color: var(--accent-green); font-weight: bold;">✓</span>';
                btn.classList.add('copy-success');

                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                    btn.classList.remove('copy-success');
                }, 1500);
            });
        }

        async function runAudit(btn, url, index) {
            // Find parent elements
            const cardBody = btn.closest('.card-v2-body');
            const logContainer = cardBody.querySelector('.audit-log-container');
            const timeline = logContainer.querySelector('.audit-timeline');
            const statusText = logContainer.querySelector('.audit-status-text');
            const linkData = emailLinks.find(l => l.index === index);

            // Reset UI
            logContainer.classList.add('active');
            timeline.innerHTML = '';
            statusText.innerHTML = 'Initiating Audit...';
            statusText.className = 'audit-status-text text-yellow';

            // Allow animation
            await new Promise(r => setTimeout(r, 300));

            try {
                if (linkData && linkData.redirect_chain && linkData.redirect_chain.length > 0) {
                    const auditDateStr = linkData.audit_date ? `<br><small style="opacity: 0.7; font-size: 0.8em;">Audit: ${linkData.audit_date}</small>` : '';
                    statusText.innerHTML = 'Analyzing Redirection Chain...' + auditDateStr;

                    let containsGtinsi = false;
                    for (let i = 0; i < linkData.redirect_chain.length; i++) {
                        const step = linkData.redirect_chain[i];
                        const isLast = i === linkData.redirect_chain.length - 1;
                        const isGtinsi = step.url && step.url.includes('gtinsi.de');
                        if (isGtinsi) containsGtinsi = true;

                        const stepClass = isGtinsi ? 'audit-step highlighted' : 'audit-step';

                        // Display the step
                        if (!isLast) {
                            // It's a redirect step
                            const nextStep = linkData.redirect_chain[i + 1];
                            timeline.innerHTML += `<div class="${stepClass}"><strong>${step.status}</strong> &rarr; ${nextStep.url}</div>`;
                        } else {
                            // It's the final destination
                            const statusColor = (step.status === 200) ? 'text-green' : (step.status >= 400 || step.status === 'Error' || step.status === 'Timeout' ? 'text-red' : 'text-cyan');
                            const statusIcon = (step.status === 200) ? 'final' : (step.status >= 400 || step.status === 'Error' || step.status === 'Timeout' ? 'error' : '');

                            timeline.innerHTML += `<div class="audit-step ${statusIcon}"><strong>${step.status || 'Done'}</strong> &bull; ${step.url}</div>`;

                            // Update status text
                            if (step.status === 200) {
                                statusText.innerHTML = containsGtinsi ? 'Verification Complete (GTINSI Detected)' : 'Verification Complete';
                            } else if (step.status === 'Timeout') {
                                statusText.innerHTML = 'Request Timed Out';
                            } else if (step.status >= 400 || step.status === 'Error') {
                                statusText.innerHTML = 'Audit Finished (Error Found)';
                            } else {
                                statusText.innerHTML = 'Audit Finished';
                            }

                            statusText.className = `audit-status-text ${statusColor}`;
                            btn.style.color = (step.status === 200) ? 'var(--accent-green)' : (step.status >= 400 || step.status === 'Error' || step.status === 'Timeout' ? 'var(--accent-red)' : 'var(--accent-cyan)');
                        }
                        await new Promise(r => setTimeout(r, 400));
                    }
                } else {
                    // Fallback for archives created before this feature or if resolution failed
                    timeline.innerHTML += `<div class="audit-step"><strong>INFO</strong> Pre-calculated redirect data missing.</div>`;
                    timeline.innerHTML += `<div class="audit-step"><strong>URL</strong> ${url}</div>`;
                    await new Promise(r => setTimeout(r, 600));
                    timeline.innerHTML += `<div class="audit-step final"><strong>ACTION</strong> Please re-archive this email to enable full redirect auditing.</div>`;
                    statusText.innerHTML = 'Direct Link Check';
                    statusText.className = 'audit-status-text text-yellow';
                    btn.style.color = 'var(--accent-yellow)';
                }

            } catch (e) {
                console.error("Audit error:", e);
                statusText.innerHTML = 'Analysis Error';
                statusText.className = 'audit-status-text text-red';
            }
        }

        async function downloadEmailZip() {
            try {
                const zip = new JSZip();
                const subject = "PSG, Real, Benfica... Jusqu'à 100€ offerts sur la soirée avec Betclic ! ⚽️ (png)".replace(/[^a-z0-9]/gi, '_').toLowerCase();
                const timestamp = new Date().toISOString().split('T')[0];
                const zipFilename = `${subject}_${timestamp}.zip`;

                // Get all images from the current directory
                const currentPath = window.location.pathname;
                const emailDir = currentPath.substring(0, currentPath.lastIndexOf('/'));

                // Find all image references in the HTML
                const doc = frame.contentDocument;
                const images = doc.querySelectorAll('img[src]');

                // Create a folder for images
                const imgFolder = zip.folder("images");

                // Download each image and track the mapping
                let downloadCount = 0;
                const imagePromises = [];
                const imageMapping = new Map(); // old path -> new path

                images.forEach((img, index) => {
                    const imgSrc = img.getAttribute('src');
                    if (imgSrc && !imgSrc.startsWith('data:') && !imgSrc.startsWith('http')) {
                        // It's a local image
                        const imgPath = emailDir + '/' + imgSrc;
                        const imgFilename = imgSrc.split('/').pop();

                        // Store the mapping: old src -> new path in zip
                        imageMapping.set(imgSrc, 'images/' + imgFilename);

                        const promise = fetch(imgPath)
                            .then(response => {
                                if (response.ok) {
                                    return response.blob();
                                }
                                throw new Error(`Failed to fetch ${imgFilename}`);
                            })
                            .then(blob => {
                                imgFolder.file(imgFilename, blob);
                                downloadCount++;
                            })
                            .catch(err => {
                                console.warn(`Could not download ${imgFilename}:`, err);
                            });

                        imagePromises.push(promise);
                    }
                });

                // Wait for all images to be added
                await Promise.all(imagePromises);

                // Fix image paths in HTML content
                let fixedHtml = content;
                imageMapping.forEach((newPath, oldPath) => {
                    // Replace all occurrences of the old path with the new path
                    const regex = new RegExp(oldPath.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                    fixedHtml = fixedHtml.replace(regex, newPath);
                });

                // Add HTML content with fixed paths
                zip.file("email.html", fixedHtml);

                // Generate zip file
                const blob = await zip.generateAsync({ type: "blob" });

                // Create download link
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = zipFilename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                console.log(`Downloaded ${downloadCount} images and HTML as ${zipFilename}`);
            } catch (error) {
                console.error('Error creating zip file:', error);
                alert('Failed to create download. Please try again.');
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === '1') setMode('mobile');
            if (e.key === '2') setMode('tablet');
            if (e.key === '3') setMode('desktop');
            if (e.key === 't' || e.key === 'T') toggleTheme();
            if (e.key === 'h' || e.key === 'H') toggleHighlightLinks();
            if (e.key === 'd' || e.key === 'D') downloadEmailZip();

            // Scroll iframe with arrows
            if (e.key === 'ArrowDown') frame.contentWindow.scrollBy(0, 150);
            if (e.key === 'ArrowUp') frame.contentWindow.scrollBy(0, -150);
        });

        init();
    </script>
</body>

</html>