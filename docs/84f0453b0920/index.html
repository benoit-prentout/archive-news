
                    <!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <meta name="creation_date" content="2025-12-09 14:44">
                        <meta name="sender" content="DUPIN Ma√´lys">
                        <meta name="archiving_date" content="2025-12-09 14:52">
                        <meta name="preheader" content="Bonjour Beno√Æt, J‚Äôesp√®re que tu vas bien. Comme demand√©, voici le lien du BAT : Et si votre plus beau cadeau √©tait solidaire
 ? ‚ú® Peux-tu me confirmer que tout...">
                        <meta name="reading_time" content="1 min">
                        <title>BAT email les petits fr√®res des pauvres</title>
                        <style>
                            body { margin: 0; padding: 0; background: #eef2f5; font-family: Roboto, Helvetica, Arial, sans-serif; overflow: hidden; }
                            .header { position: fixed; top: 0; left: 0; right: 0; height: 60px; background: white; border-bottom: 1px solid #ddd; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
                            .title { font-size: 16px; font-weight: 600; color: #333; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-right: 20px; }
                            .controls { display: flex; gap: 10px; flex-shrink: 0; }
                            .btn { padding: 6px 12px; border: 1px solid #ccc; background: #f9f9f9; border-radius: 6px; cursor: pointer; font-size: 13px; display: flex; align-items: center; gap: 6px; transition: all 0.2s; color: #333; }
                            .btn:hover { background: #eee; }
                            .btn.active { background: #0070f3; color: white; border-color: #0070f3; }
                            .btn svg { display: block; }
                            .main-view { margin-top: 60px; height: calc(100vh - 60px); display: flex; justify-content: center; align-items: flex-start; background: #eef2f5; overflow: hidden; padding-top: 20px; }
                            .iframe-wrapper { width: 1000px; max-width: 95%; height: 90%; transition: width 0.3s ease; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-radius: 4px; }
                            iframe { width: 100%; height: 100%; border: none; display: block; border-radius: inherit; }
                            body.mobile-mode .iframe-wrapper { width: 375px; height: 812px; max-height: 85vh; border: none; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
                            
                            /* --- SIDEBAR --- */
                            .sidebar { position: fixed; top: 60px; right: -420px; width: 420px; height: calc(100vh - 60px); background: white; border-left: 1px solid #ddd; transition: right 0.3s; overflow-y: auto; z-index: 90; padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; gap: 20px; }
                            .sidebar.open { right: 0; }
                            
                            .sidebar h3 { margin-top: 0; font-size: 16px; color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
                            .meta-item { margin-bottom: 12px; font-size: 13px; color: #555; }
                            .meta-label { font-weight: 600; display: block; margin-bottom: 3px; color: #333; }
                            .meta-val { word-break: break-word; line-height: 1.4; }
                            .preheader-box { background: #f8f9fa; padding: 10px; border-radius: 6px; border: 1px solid #eee; font-style: italic; color: #666; font-size: 12px; }
                            
                            .status-badge { display: inline-flex; align-items: center; gap: 5px; font-weight: 500; }
                            .status-badge.ok { color: green; }
                            .status-badge.warn { color: orange; }
                            
                            /* Pixel List Style */
                            .pixel-list { list-style: none; padding: 0; margin: 0; background: #f0fff4; border: 1px solid #c3e6cb; border-radius: 4px; }
                            .pixel-li { padding: 8px; border-bottom: 1px solid #c3e6cb; }
                            .pixel-li:last-child { border-bottom: none; }
                            .pixel-row { display: flex; align-items: center; gap: 6px; color: #155724; font-size: 11px; }
                            .pixel-url { word-break: break-all; font-family: monospace; }
                            
                            /* --- LINK CARD DESIGN --- */
                            .sidebar ul { list-style: none; padding: 0; margin: 0; }
                            .link-card {
                                border: 1px solid #eee; border-radius: 8px; background: #fff; margin-bottom: 12px;
                                box-shadow: 0 1px 3px rgba(0,0,0,0.05); overflow: hidden;
                            }
                            .link-card-header {
                                padding: 8px 12px; background: #fcfcfc; border-bottom: 1px solid #f0f0f0;
                                font-weight: 600; color: #333; font-size: 12px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;
                                display: flex; align-items: center; gap: 8px;
                            }
                            .link-number {
                                background: #eee; color: #555; padding: 1px 5px; border-radius: 4px; font-size: 10px; font-family: monospace;
                            }
                            .link-card-body { padding: 10px 12px; }
                            .link-line { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
                            .link-line:last-child { margin-bottom: 0; }
                            .link-icon-box { width: 16px; text-align: center; display: flex; justify-content: center; }
                            .link-url-text { font-family: monospace; font-size: 11px; word-break: break-all; line-height: 1.3; }
                            .link-url-text.orig { color: #888; }
                            .link-url-text.dest { color: #0070f3; font-weight: 600; }
                            .link-arrow-sep { padding-left: 20px; color: #ccc; font-size: 10px; margin: 2px 0; }
                            
                            .link-card-footer {
                                padding: 6px 12px; background: #fafafa; border-top: 1px solid #f0f0f0; display: flex; gap: 10px; justify-content: flex-end;
                            }
                            .btn-action {
                                border: none; background: transparent; padding: 4px 8px; cursor: pointer; color: #666;
                                display: flex; align-items: center; gap: 4px; font-size: 11px; border-radius: 4px;
                            }
                            .btn-action:hover { background: #eaeaea; color: #0070f3; }
                            
                            /* Global Tooltip Fixed */
                            .global-tooltip {
                                position: fixed; background: #333; color: white; padding: 10px; border-radius: 6px;
                                z-index: 10000; max-width: 300px; font-size: 11px; pointer-events: none; display: none;
                                box-shadow: 0 4px 10px rgba(0,0,0,0.2); white-space: pre-wrap; word-break: break-all; line-height: 1.4;
                            }
                            .global-tooltip.visible { display: block; }

                            body.dark-mode .main-view { background: #121212; }
                            body.dark-mode .header { background: #1e1e1e; border-bottom-color: #333; }
                            body.dark-mode .title { color: #e0e0e0; }
                            body.dark-mode .btn { background: #2c2c2c; border-color: #444; color: #ccc; }
                            body.dark-mode .btn.active { background: #0070f3; color: white; }
                            body.dark-mode .iframe-wrapper { box-shadow: 0 0 25px rgba(255, 255, 255, 0.15); border: 1px solid #333; }
                            body.dark-mode .sidebar { background: #1e1e1e; border-left-color: #333; }
                            body.dark-mode .sidebar h3 { color: #fff; border-bottom-color: #333; }
                            body.dark-mode .meta-label { color: #ccc; }
                            body.dark-mode .meta-item { color: #aaa; }
                            body.dark-mode .preheader-box { background: #252525; border-color: #333; color: #aaa; }
                            
                            body.dark-mode .pixel-list { background: #1e2e1e; border-color: #2b4c2b; }
                            body.dark-mode .pixel-li { border-bottom-color: #2b4c2b; }
                            body.dark-mode .pixel-row { color: #90cea1; }
                            
                            body.dark-mode .link-card { background: #252525; border-color: #333; }
                            body.dark-mode .link-card-header { background: #2c2c2c; border-bottom-color: #333; color: #ddd; }
                            body.dark-mode .link-number { background: #333; color: #ccc; }
                            body.dark-mode .link-card-footer { background: #2c2c2c; border-top-color: #333; }
                            body.dark-mode .link-url-text.dest { color: #4da3ff; }
                            body.dark-mode .btn-action { color: #aaa; }
                            body.dark-mode .btn-action:hover { background: #333; color: #fff; }
                        </style>
                    </head>
                    <body>
                        <div id="global-tooltip" class="global-tooltip"></div>
                        <header class="header">
                            <div class="title">BAT email les petits fr√®res des pauvres</div>
                            <div class="controls">
                                <button class="btn" onclick="toggleLanguage()" id="lang-toggle" title="Switch Language">
                                    <span><svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></span>&nbsp;FR
                                </button>
                                <button class="btn" onclick="toggleHighlight()" id="btn-highlight" data-i18n-btn="btn_highlight">
                                    <span><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><line x1="22" y1="12" x2="18" y2="12"></line><line x1="6" y1="12" x2="2" y2="12"></line><line x1="12" y1="6" x2="12" y2="2"></line><line x1="12" y1="22" x2="12" y2="18"></line></svg></span>&nbsp;Highlight
                                </button>
                                <button class="btn" onclick="toggleLinks()" id="btn-links" data-i18n-btn="btn_infos">
                                    <span><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg></span>&nbsp;Infos
                                </button>
                                <button class="btn" onclick="toggleMobile()" id="btn-mobile" data-i18n-btn="btn_mobile">
                                    <span><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg></span>&nbsp;Mobile
                                </button>
                                <button class="btn" onclick="toggleDark()" id="btn-dark" data-i18n-btn="btn_dark">
                                    <span><svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>&nbsp;Dark
                                </button>
                            </div>
                        </header>
                        <div class="main-view">
                            <div class="iframe-wrapper"><iframe id="emailFrame"></iframe></div>
                        </div>
                        <div class="sidebar" id="sidebar">
                            
                            <!-- 1. METADATA (FIRST) -->
                            <div class="sidebar-section">
                                <h3 data-i18n="meta_section"><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> Metadata</h3>
                                <div class="meta-item"><span class="meta-label" data-i18n="label_sent">üìÖ Sent Date</span><span class="meta-val">09/12/2025 √† 14:44</span></div>
                                <div class="meta-item"><span class="meta-label" data-i18n="label_archived">üóÑÔ∏è Archived Date</span><span class="meta-val">09/12/2025 √† 14:52</span></div>
                                <div class="meta-item"><span class="meta-label" data-i18n="label_reading">‚è±Ô∏è Reading Time</span><span class="meta-val">1 min</span></div>
                                <div class="meta-item"><span class="meta-label" data-i18n="label_preheader">üëÄ Preheader (Preview)</span><div class="preheader-box">Bonjour Beno√Æt, J‚Äôesp√®re que tu vas bien. Comme demand√©, voici le lien du BAT : Et si votre plus beau cadeau √©tait solidaire
 ? ‚ú® Peux-tu me confirmer que tout...</div></div>
                            </div>
                            
                            <!-- 2. PIXELS (SECOND) -->
                            <div class="sidebar-section">
                                <h3 data-i18n="pixel_section"><svg viewBox="0 0 24 24" width="14" height="14" stroke="orange" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg> Tracking Pixel(s)</h3>
                                
                        <div class="meta-item">
                            <span class="status-badge warn"><span class="icon-status"><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg></span> <span data-i18n="no_pixels">No trackers detected</span></span>
                        </div>
                        
                            </div>
                            
                            <div class="sidebar-section">
                                <h3 data-i18n="links_section"><svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Detected Links (2)</h3>
                                <ul>
                        <li class="link-card">
                            <div class="link-card-header">
                                <span class="link-number">#1</span>
                                Et si votre plus beau cadeau √©tait solidaire
 ? ‚ú®
                            </div>
                            <div class="link-card-body">
                                <div class="link-line" title="Original Link">
                                    <span class="link-icon-box"><svg viewBox="0 0 24 24" width="12" height="12" stroke="#666" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span>
                                    <span class="link-url-text orig">https://m12.news.laredoute.fr/nl/jsp/m.jsp?c=%40ZjsuVij94BLhiH5jhWo3xtfKDcoxoUzYee534qWfsZg%2BkPxJlC36oqitT8EPXXPNRCa8NzNl5xI5BxuE3moHpQ%3D%3D</span>
                                </div>
                                <div class="link-arrow-sep"><svg viewBox="0 0 24 24" width="10" height="10" stroke="#ccc" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg></div>
                                <div class="link-line" title="Destination Link">
                                    <span class="link-icon-box"><svg viewBox="0 0 24 24" width="12" height="12" stroke="#0070f3" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M2 12h20"></path><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></span>
                                    <span class="link-url-text dest">https://m12.news.laredoute.fr/nl/jsp/m.jsp?c=%40ZjsuVij94BLhiH5jhWo3xtfKDcoxoUzYee534qWfsZg%2BkPxJlC36oqitT8EPXXPNRCa8NzNl5xI5BxuE3moHpQ%3D%3D</span>
                                </div>
                            </div>
                            <div class="link-card-footer">
                                <button class="btn-action btn-chain" data-tooltip="https://m12.news.laredoute.fr/nl/jsp/m.jsp?c=%40ZjsuVij94BLhiH5jhWo3xtfKDcoxoUzYee534qWfsZg%2BkPxJlC36oqitT8EPXXPNRCa8NzNl5xI5BxuE3moHpQ%3D%3D" title="Show Redirect Path">
                                    <svg viewBox="0 0 24 24" width="12" height="12" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Path
                                </button>
                                <button class="btn-action" onclick="scrollToLink('detected-link-0')" title="Locate in Email">
                                    <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> Locate
                                </button>
                                <button class="btn-action" onclick="copyToClipboard('https://m12.news.laredoute.fr/nl/jsp/m.jsp?c=%40ZjsuVij94BLhiH5jhWo3xtfKDcoxoUzYee534qWfsZg%2BkPxJlC36oqitT8EPXXPNRCa8NzNl5xI5BxuE3moHpQ%3D%3D')" title="Copy Final URL">
                                    <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy
                                </button>
                            </div>
                        </li>
                        
                        <li class="link-card">
                            <div class="link-card-header">
                                <span class="link-number">#2</span>
                                @redoute.fr
                            </div>
                            <div class="link-card-body">
                                <div class="link-line" title="Original Link">
                                    <span class="link-icon-box"><svg viewBox="0 0 24 24" width="12" height="12" stroke="#666" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 16 16 12 12 8"></polyline><line x1="8" y1="12" x2="16" y2="12"></line></svg></span>
                                    <span class="link-url-text orig">mailto:alarger@redoute.fr</span>
                                </div>
                                <div class="link-arrow-sep"><svg viewBox="0 0 24 24" width="10" height="10" stroke="#ccc" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg></div>
                                <div class="link-line" title="Destination Link">
                                    <span class="link-icon-box"><svg viewBox="0 0 24 24" width="12" height="12" stroke="#0070f3" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M2 12h20"></path><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></span>
                                    <span class="link-url-text dest">mailto:alarger@redoute.fr</span>
                                </div>
                            </div>
                            <div class="link-card-footer">
                                <button class="btn-action btn-chain" data-tooltip="" title="Show Redirect Path">
                                    <svg viewBox="0 0 24 24" width="12" height="12" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Path
                                </button>
                                <button class="btn-action" onclick="scrollToLink('detected-link-1')" title="Locate in Email">
                                    <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg> Locate
                                </button>
                                <button class="btn-action" onclick="copyToClipboard('mailto:alarger@redoute.fr')" title="Copy Final URL">
                                    <svg viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy
                                </button>
                            </div>
                        </li>
                        </ul>
                            </div>
                        </div>
                        <script>
                            
const TRANSLATIONS = {"en": {"page_title": "Newsletter Archive", "search_placeholder": "Search by title, sender or date...", "btn_infos": "Infos", "btn_mobile": "Mobile", "btn_dark": "Dark", "btn_highlight": "Highlight", "meta_section": "Metadata", "pixel_section": "Tracking Pixel(s)", "label_sent": "Sent Date", "label_archived": "Archived Date", "label_reading": "Reading Time", "label_preheader": "Preheader", "label_pixel_status": "Summary", "no_pixels": "No trackers detected", "pixel_active_msg": "active(s) (Will be counted)", "links_section": "Detected Links", "legal_summary": "Legal Notice", "legal_publisher": "Publisher", "legal_hosting": "Hosting", "legal_text": "This site is a personal archive.", "tooltip_sent": "Received Date", "tooltip_archived": "Archived Date"}, "fr": {"page_title": "Archives Newsletters", "search_placeholder": "Rechercher par titre, exp\u00e9diteur ou date...", "btn_infos": "Infos", "btn_mobile": "Mobile", "btn_dark": "Sombre", "btn_highlight": "Surligner", "meta_section": "M\u00e9tadonn\u00e9es", "pixel_section": "Pixel(s) de Tracking", "label_sent": "Date d'envoi", "label_archived": "Date d'archivage", "label_reading": "Temps de lecture", "label_preheader": "Pr\u00e9-header", "label_pixel_status": "R\u00e9sum\u00e9", "no_pixels": "Aucun traceur d\u00e9tect\u00e9", "pixel_active_msg": "actif(s) (Sera pris en compte)", "links_section": "Liens d\u00e9tect\u00e9s", "legal_summary": "Mentions L\u00e9gales", "legal_publisher": "\u00c9diteur", "legal_hosting": "H\u00e9bergement", "legal_text": "Ce site est une archive personnelle.", "tooltip_sent": "Date de r\u00e9ception", "tooltip_archived": "Date d'archivage"}};
let currentLang = localStorage.getItem('lang') || 'en';

function updateLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('lang', lang);
    const t = TRANSLATIONS[lang];
    
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.textContent = t[key];
    });
    
    const searchInput = document.getElementById('searchInput');
    if (searchInput && t['search_placeholder']) searchInput.placeholder = t['search_placeholder'];
    
    document.querySelectorAll('[data-i18n-title]').forEach(el => {
        const key = el.getAttribute('data-i18n-title');
        if (t[key]) el.title = t[key];
    });

    document.querySelectorAll('.btn[data-i18n-btn]').forEach(el => {
        const key = el.getAttribute('data-i18n-btn');
        if (t[key]) {
            const icon = el.firstElementChild;
            el.innerHTML = ''; 
            el.appendChild(icon);
            el.appendChild(document.createTextNode(' ' + t[key]));
        }
    });
    
    const langBtn = document.getElementById('lang-toggle');
    if(langBtn) langBtn.innerHTML = `<span><svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></span>&nbsp;${lang === 'en' ? 'FR' : 'EN'}`;
}

function toggleLanguage() {
    const newLang = currentLang === 'en' ? 'fr' : 'en';
    updateLanguage(newLang);
}

updateLanguage(currentLang);

                            const emailContent = "<html>\n<head>\n\n<style style=\"display:none;\" type=\"text/css\"> P {margin-top:0;margin-bottom:0;} </style>\n</head>\n<body dir=\"ltr\">\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\r\nBonjour Beno\u00eet,</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\n<br/>\n</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\r\nJ\u2019esp\u00e8re que tu vas bien.<br/>\r\nComme demand\u00e9, voici le lien du BAT :</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\n<a class=\"OWAAutoLink\" data-index=\"1\" href=\"https://m12.news.laredoute.fr/nl/jsp/m.jsp?c=%40ZjsuVij94BLhiH5jhWo3xtfKDcoxoUzYee534qWfsZg%2BkPxJlC36oqitT8EPXXPNRCa8NzNl5xI5BxuE3moHpQ%3D%3D\" id=\"detected-link-0\">Et si votre plus beau cadeau \u00e9tait solidaire\r\n ? \u2728</a></div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\r\nPeux-tu me confirmer que tout est OK pour toi ?</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\n<br/>\n</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\r\nBonne journ\u00e9e,</div>\n<div class=\"elementToProof\" style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\r\nMa\u00eblys</div>\n<div id=\"Signature\">\n<table id=\"x_table_0\" style=\"text-align: left; background-color: rgb(255, 255, 255); color: rgb(36, 36, 36); box-sizing: border-box; border-collapse: collapse; border-spacing: 0px;\">\n<tbody>\n<tr>\n<td style=\"text-align: left; padding-right: 11.25pt; width: 68.4184px; height: 22px; box-sizing: border-box;\">\n<p style=\"text-align: left; margin-top: 0px; margin-bottom: 0px;\"><span style='font-family: \"Segoe UI\", \"Segoe UI Web (West European)\", -apple-system, BlinkMacSystemFont, Roboto, \"Helvetica Neue\", sans-serif; font-size: 15px; color: rgb(36, 36, 36);'><img data-olk-copy-source=\"MessageBody\" data-outlook-trace=\"F:2|T:2\" height=\"140\" id=\"x_image_0_0\" src=\"cid:80298f19-0711-4c92-8125-78d99369d535\" style=\"width: 164px; height: 140px; min-width: auto; min-height: auto; margin: 0px;\" width=\"164\"/></span></p>\n</td>\n<td style=\"text-align: left; width: 135.91px; height: 22px; box-sizing: border-box;\">\n<table id=\"x_table_1\" style=\"text-align: left; box-sizing: border-box; border-collapse: collapse; border-spacing: 0px;\">\n<tbody>\n<tr>\n<td style=\"text-align: left; width: 34px; height: 22px; box-sizing: border-box;\">\n<p style=\"text-align: left; margin-top: 0px; margin-bottom: 0px;\"><span style=\"font-family: Poppins; font-size: 10.5pt; color: rgb(36, 36, 36);\"><b>Ma\u00eblys DUPIN</b></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"text-align: left; width: 34px; height: 22px; box-sizing: border-box;\">\n<div style=\"text-align: left; margin: 0px; font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 11pt; color: black;\">\r\nJunior Sales Manager</div>\n</td>\n</tr>\n<tr>\n<td style=\"text-align: left; width: 34px; height: 22px; box-sizing: border-box;\">\n<p style=\"text-align: left; margin-top: 0px; margin-bottom: 0px;\"><span style=\"font-family: Poppins; font-size: 10.5pt; color: rgb(12, 100, 192);\"><u>mdupin<a data-index=\"2\" data-linkindex=\"0\" href=\"mailto:alarger@redoute.fr\" id=\"detected-link-1\" style=\"color: rgb(12, 100, 192); margin: 0px;\" title=\"mailto:alarger@redoute.fr\">@redoute.fr</a></u></span></p>\n</td>\n</tr>\n</tbody>\n</table>\n</td>\n</tr>\n</tbody>\n</table>\n<div style=\"font-family: Aptos, Aptos_EmbeddedFont, Aptos_MSFontService, Calibri, Helvetica, sans-serif; font-size: 12pt; color: rgb(0, 0, 0);\">\n<br/>\n</div>\n</div>\r\nLes informations contenues dans ce message ainsi que dans les pi\u00e8ces jointes sont strictement confidentielles et r\u00e9serv\u00e9es \u00e0 l'usage exclusif de ses destinataires. Si vous prenez connaissance de ce message sans en \u00eatre le (la) destinataire, vous \u00eates pri\u00e9(e)\r\n d'en aviser imm\u00e9diatement l'\u00e9metteur et de le d\u00e9truire sous toutes ses formes. Toute diffusion ou publication, totale ou partielle, est interdite sauf autorisation expresse de l'\u00e9metteur. Les meilleurs efforts sont faits pour maintenir cette transmission exempte\r\n de tout virus mais l'int\u00e9grit\u00e9 de ce message n'est pas assur\u00e9e sur Internet : il a pu \u00eatre alt\u00e9r\u00e9 ou falsifi\u00e9. Les points de vue ou avis \u00e9manent de son auteur et ne repr\u00e9sentent pas n\u00e9cessairement ceux de la Soci\u00e9t\u00e9. Son contenu ne peut engager la responsabilit\u00e9\r\n de La Redoute et de ses filiales. This message and any attachments are strictly confidential and intended solely for the addressees. If you have received this message in error please delete it and notify the sender immediately. Any dissemination or disclosure,\r\n either whole or partial, is prohibited except formal approval of the sender. Best efforts are made in order to keep this message free of virus, but integrity of this message is not guaranteed through the Internet : it could have been altered or falsified.\r\n The views or opinions presented here are solely of the author and do not necessarily represent those of the Enterprise. Its content cannot bind La Redoute and its subsidiaries.\r\n</body>\n</html>\n";
                            const frame = document.getElementById('emailFrame');
                            frame.contentDocument.open();
                            frame.contentDocument.write(emailContent);
                            const meta = frame.contentDocument.createElement('meta');
                            meta.name = 'viewport';
                            meta.content = 'width=device-width, initial-scale=1.0';
                            frame.contentDocument.head.appendChild(meta);
                            const base = frame.contentDocument.createElement('base');
                            base.target = '_blank';
                            frame.contentDocument.head.appendChild(base);
                            frame.contentDocument.close();
                            const style = frame.contentDocument.createElement('style');
                            style.textContent = `
                                html { -ms-overflow-style: none; scrollbar-width: none; }
                                html::-webkit-scrollbar { display: none; }
                                body::-webkit-scrollbar { display: none; width: 0; }
                                body { margin: 0; padding: 0; font-family: Roboto, Helvetica, Arial, sans-serif; color: #222; line-height: 1.5; overflow-wrap: break-word; }
                                table { border-spacing: 0; border-collapse: collapse; }
                                img { height: auto !important; vertical-align: middle; border: 0; }
                                img[style*="display: block"], img[style*="display:block"] { margin-left: auto !important; margin-right: auto !important; }
                                a, .link-text { color: #1a0dab; }
                                html.dark-mode-internal { filter: invert(1) hue-rotate(180deg); }
                                html.dark-mode-internal img, html.dark-mode-internal video, html.dark-mode-internal [style*="background-image"] { filter: invert(1) hue-rotate(180deg); }
                                
                                /* --- MODIF: BETTER HIGHLIGHT (SHADOW INSTEAD OF BORDER) --- */
                                body.highlight-links a { 
                                    position: relative; 
                                    box-shadow: 0 0 0 3px red, 0 0 10px yellow !important; 
                                    background-color: rgba(255, 255, 0, 0.2); 
                                    z-index: 9999;
                                    display: inline-block;
                                }
                                /* Filter for images inside links to follow shape */
                                body.highlight-links a img { 
                                    filter: drop-shadow(0 0 3px red); 
                                }
                                
                                /* --- OVERLAY BADGE STYLE --- */
                                .link-badge-overlay {
                                    position: absolute;
                                    z-index: 2147483647;
                                    background: black;
                                    color: white;
                                    border: 1px solid white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    font-size: 10px;
                                    font-weight: bold;
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                                    pointer-events: none;
                                }

                                @keyframes target-pulse { 
                                    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
                                    50% { transform: scale(1.05); box-shadow: 0 0 20px 10px rgba(255, 0, 0, 0); }
                                    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
                                }
                                a.flash-target {
                                    position: relative;
                                    z-index: 99999;
                                    outline: 10px solid #ff0000 !important;
                                    background-color: rgba(255, 255, 0, 0.5) !important;
                                    animation: target-pulse 0.5s ease-in-out 4; /* 4 pulses */
                                    box-shadow: 0 0 50px rgba(255,0,0,1); /* Big glow */
                                }

                                @media screen and (max-width: 600px) { table, tbody, tr, td { width: 100% !important; min-width: 0 !important; box-sizing: border-box !important; height: auto !important; } div[style*="width"] { width: 100% !important; max-width: 100% !important; } img { width: auto !important; max-width: 100% !important; } }
                            `;
                            frame.contentDocument.head.appendChild(style);
                            
                            function toggleMobile() { document.body.classList.toggle('mobile-mode'); document.getElementById('btn-mobile').classList.toggle('active'); }
                            function toggleDark() { document.body.classList.toggle('dark-mode'); document.getElementById('btn-dark').classList.toggle('active'); if(frame.contentDocument.documentElement) { frame.contentDocument.documentElement.classList.toggle('dark-mode-internal'); } }
                            function toggleLinks() { document.getElementById('sidebar').classList.toggle('open'); document.getElementById('btn-links').classList.toggle('active'); }
                            
                            function toggleHighlight() { 
                                const btn = document.getElementById('btn-highlight');
                                const doc = frame.contentDocument;
                                const body = doc.body;
                                
                                body.classList.toggle('highlight-links');
                                btn.classList.toggle('active');
                                
                                const isActive = body.classList.contains('highlight-links');
                                
                                if (isActive) {
                                    // GENERATE OVERLAY BADGES
                                    const links = doc.querySelectorAll('a[data-index]');
                                    links.forEach(link => {
                                        const rect = link.getBoundingClientRect();
                                        // Ignore hidden links
                                        if(rect.width === 0 || rect.height === 0) return;
                                        
                                        const badge = doc.createElement('div');
                                        badge.className = 'link-badge-overlay';
                                        badge.textContent = link.getAttribute('data-index');
                                        // Absolute positioning relative to body (scrolled)
                                        badge.style.top = (rect.top + doc.documentElement.scrollTop - 10) + 'px';
                                        badge.style.left = (rect.left + doc.documentElement.scrollLeft - 10) + 'px';
                                        body.appendChild(badge);
                                    });
                                } else {
                                    // REMOVE BADGES
                                    const badges = doc.querySelectorAll('.link-badge-overlay');
                                    badges.forEach(b => b.remove());
                                }
                            }
                            
                            function copyToClipboard(text) { navigator.clipboard.writeText(text).then(() => { }).catch(err => { console.error('Failed to copy: ', err); }); }
                            function scrollToLink(id) { const el = frame.contentDocument.getElementById(id); if(el) { el.scrollIntoView({behavior: 'smooth', block: 'center'}); el.classList.add('flash-target'); setTimeout(() => el.classList.remove('flash-target'), 2000); } else { console.warn('Link not found in iframe:', id); } }
                            
                            // TOOLTIP LOGIC SMART POSITION
                            const tooltip = document.getElementById('global-tooltip');
                            document.querySelectorAll('[data-tooltip]').forEach(btn => {
                                btn.addEventListener('mouseenter', e => {
                                    const text = btn.getAttribute('data-tooltip');
                                    if(text) {
                                        tooltip.textContent = text;
                                        tooltip.classList.add('visible');
                                        
                                        const rect = btn.getBoundingClientRect();
                                        const viewportHeight = window.innerHeight;
                                        
                                        tooltip.style.right = (window.innerWidth - rect.left + 10) + 'px';
                                        tooltip.style.left = 'auto';

                                        if (rect.top > viewportHeight / 2) {
                                            tooltip.style.top = 'auto';
                                            tooltip.style.bottom = (viewportHeight - rect.bottom) + 'px';
                                        } else {
                                            tooltip.style.top = rect.top + 'px';
                                            tooltip.style.bottom = 'auto';
                                        }
                                    }
                                });
                                btn.addEventListener('mouseleave', () => {
                                    tooltip.classList.remove('visible');
                                });
                            });
                        </script>
                    </body>
                    </html>
                    